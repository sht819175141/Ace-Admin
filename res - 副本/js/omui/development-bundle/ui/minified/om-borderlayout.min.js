(function(a){a.omWidget("om.omBorderLayout",{options:{fit:false,spacing:5,hideCollapsBtn:false,onBeforeDrag:function(b,c){},onAfterDrag:function(b,c){}},_create:function(){if(!this.options.panels){return}this._minWidth=50;this._minHeight=28;this._buildRegion();this._resizeRegion(true);a(window).resize(a.proxy(this,"_resizeRegion"))},_getRegionSize:function(e){var b=this._getRegion(e),c=this._getRegionProxy(e),d={};d.width=this._regionVisible(b)?b.outerWidth(true):(this._regionVisible(c)?c.outerWidth(true):0);d.height=this._regionVisible(b)?b.outerHeight(true):(this._regionVisible(c)?c.outerHeight(true):0);return d},_resizeRegion:function(u){var k=this._getRegion("center"),e=this._getRegion("north"),b=this._getRegion("south"),l=this._getRegion("west"),t=this._getRegion("east"),d=this._getRegionProxy("north"),f=this._getRegionProxy("south"),i=this._getRegionProxy("west"),s=this._getRegionProxy("east"),c=this._getRegionSize("north").height;southHeight=this._getRegionSize("south").height;westWidth=this._getRegionSize("west").width;eastWidth=this._getRegionSize("east").width;centerWidth=this._getRegionSize("center").width;layoutWidth=this.element.width();layoutHeight=this.element.height();westOpt=this._getPanelOpts("west");eastOpt=this._getPanelOpts("east");k.css({top:c,left:westWidth});k.find(">.om-panel-body").omPanel("resize",{height:layoutHeight-c-southHeight});if(!u){k.find(">.om-panel-body").omPanel("resize",{width:layoutWidth-westWidth-eastWidth})}var n=k.outerHeight(true);if(e){var p=layoutWidth-(westOpt.expandToTop?westWidth:0)-(eastOpt.expandToTop?eastWidth:0);e.find(">.om-panel-body").omPanel("resize",{width:p});e.css({left:westOpt.expandToTop?westWidth:0});if(d){d.outerWidth(p).css({left:westOpt.expandToTop?westWidth:0})}}if(b){var q=layoutWidth-(westOpt.expandToBottom?westWidth:0)-(eastOpt.expandToBottom?eastWidth:0);b.find(">.om-panel-body").omPanel("resize",{width:q});b.css({top:layoutHeight-b.outerHeight(true),left:westOpt.expandToBottom?westWidth:0});if(f){f.outerWidth(q).css({left:westOpt.expandToBottom?westWidth:0})}}if(l){var j=westOpt.expandToTop?0:c;var h=n+(westOpt.expandToBottom?southHeight:0)+(westOpt.expandToTop?c:0);l.css({top:j});l.find(">.om-panel-body").omPanel("resize",{height:h});if(i){i.css({top:j});i.outerHeight(h)}}if(t){var m=eastOpt.expandToTop?0:c;var o=n+(eastOpt.expandToBottom?southHeight:0)+(eastOpt.expandToTop?c:0);t.css({top:m});t.find(">.om-panel-body").omPanel("resize",{height:o});if(s){s.css({top:m});s.outerHeight(o)}}if(u){var r=this._getPanelOpts("east")&&!this._getPanelOpts("east").width;var g=this._getPanelOpts("west")&&!this._getPanelOpts("west").width;var v=!this._getPanelOpts("center").width;if(r||g||v){if(!v&&r&&g){eastWidth=westWidth=(layoutWidth-centerWidth)/2}else{if(v&&!r&&g){centerWidth=westWidth=(layoutWidth-eastWidth)/2}else{if(v&&r&&!g){centerWidth=eastWidth=(layoutWidth-westWidth)/2}else{if(v&&r&&g){eastWidth=westWidth=centerWidth=layoutWidth/3}}}}}if(v){k.find(">.om-panel-body").omPanel("resize",{width:Math.floor(layoutWidth-westWidth-eastWidth)})}if(r){t.find(">.om-panel-body").omPanel("resize",{width:Math.ceil(layoutWidth-westWidth-centerWidth)-this.options.spacing})}if(g){l.find(">.om-panel-body").omPanel("resize",{width:Math.ceil(layoutWidth-eastWidth-centerWidth)-this.options.spacing});k.css({left:l.width()+this.options.spacing})}}},_regionVisible:function(b){return b&&b.css("display")!="none"},_createRegionProxy:function(e,f){var c=this;var b="";if(f){b='<div class="om-borderlayout-proxy om-borderlayout-trigger-proxy-'+e.region+'" proxy="'+e.region+'"><div class="om-borderlayout-expand-trigger"></div></div>';var d=a(b);if(e.region=="west"||e.region=="east"){d.width(c.options.spacing)}else{if(e.region=="north"||e.region=="south"){d.height(c.options.spacing)}}(function(g){d.find(".om-borderlayout-expand-trigger").click(function(){c.expandRegion(g.region)})})(e)}else{b='<div class="om-borderlayout-proxy om-borderlayout-proxy-'+e.region+'" proxy="'+e.region+'"><div class="om-panel-title"></div><div class="om-panel-tool"><div class="om-icon panel-tool-expand"></div></div></div>';var d=a(b);(function(g){d.find(".panel-tool-expand").hover(function(){a(this).toggleClass("panel-tool-expand-hover")}).click(function(){c.expandRegion(g.region)})})(e)}d.hover(function(){a(this).toggleClass("om-borderlayout-proxy-hover")}).appendTo(this.element)},_buildRegion:function(){var j=this;var c=this.element;this.element.addClass("om-borderlayout");if(this.options.hideCollapsBtn){this.element.addClass("om-borderlayout-hide-collaps-btn")}if(this.options.fit){c.css({width:"100%",height:"100%"})}for(var g=0;g<this.options.panels.length;g++){var b=a.extend({},this.options.panels[g]);var k=this.element.find("#"+b.id);var m=b.collapsible&&j.options.hideCollapsBtn;if(b.collapsible&&b.region!="center"){this._createRegionProxy(b,m)}if(b.collapsible){a.extend(b,{collapsible:false});if(!j.options.hideCollapsBtn){a.extend(b,{tools:[{iconCls:["panel-tool-collapse","panel-tool-collapse-hover"],handler:function(i){j.collapseRegion(i.element.parent().attr("region"))}}]})}}if(b.closable){var d=b.onClose;a.extend(b,{onClose:function(){d&&d.call(k[0]);j._resizeRegion()}})}k.omPanel(b);if(b.region=="north"||b.region=="south"){k.omPanel("resize",{width:c.width()})}var f="0",h=this.options.spacing+"px";if(b.resizable&&b.region!="center"){var l="";handleClass={};if(b.region=="west"){l="e";handleClass.width=h;handleClass.right="-"+h}else{if(b.region=="east"){l="w";handleClass.width=h;handleClass.left="-"+h}else{if(b.region=="south"){l="n";handleClass.height=h;handleClass.top="-"+h}else{if(b.region=="north"){l="s";handleClass.height=h;handleClass.bottom="-"+h}}}}k.parent().omResizable({handles:l,helper:"om-borderlayout-resizable-helper-"+l,stop:function(n,i){c.find(">.om-borderlayout-mask").remove();n.element.find(">.om-panel-body").omPanel("resize",n.size);j._resizeRegion();j.options.onAfterDrag&&j._trigger("onAfterDrag",null,n.element)},start:function(q,p){var o=q.element.omResizable("option","helper");a("body").find("."+o).css("border-width",j.options.spacing);var r=q.element.attr("region"),n=c.width()-2*j._minWidth,i=c.height()-2*j._minHeight;if(r=="west"){n=c.width()-(j._getRegionSize("east").width+j._minWidth);q.element.omResizable("option","maxWidth",n)}else{if(r=="east"){n=c.width()-(j._getRegionSize("west").width+j._minWidth);q.element.omResizable("option","maxWidth",n)}else{if(r=="north"){i=c.height()-(j._getRegionSize("south").height+j._minHeight+j.options.spacing);q.element.omResizable("option","maxHeight",i)}else{if(r=="south"){i=c.height()-(j._getRegionSize("north").height+j._minHeight+j.options.spacing);q.element.omResizable("option","maxHeight",i)}}}}a('<div class="om-borderlayout-mask"></div>').css({width:c.width(),height:c.height()}).appendTo(c);j.options.onBeforeDrag&&j._trigger("onBeforeDrag",null,q.element)},minWidth:j._minWidth,minHeight:j._minHeight});k.parent().find(".om-resizable-handle").css(handleClass);f=(b.region=="south"?h:0)+" "+(b.region=="west"?h:0)+" "+(b.region=="north"?h:0)+" "+(b.region=="east"?h:0);if(m){var e=a("<div class='om-borderlayout-collaps-trigger-"+b.region+"'></div>");(function(i){e.click(function(){j.collapseRegion(i.attr("region"))})})(k.parent());k.parent().find(".om-resizable-handle").append(e)}}k.parent().addClass("om-borderlayout-region").addClass("om-borderlayout-region-"+b.region).css("margin",f).attr("region",b.region);k.addClass("om-borderlayout-region-body");k.prev().addClass("om-borderlayout-region-header")}},_getRegion:function(c){var b=this.element.find('>[region="'+c+'"]');return b.size()>0?b:false},_getRegionProxy:function(b){var c=this.element.find('>[proxy="'+b+'"]');return c.size()>0?c:false},_getPanelOpts:function(c){for(var b=0;b<this.options.panels.length;b++){if(c==this.options.panels[b].region){return this.options.panels[b]}}return false},collapseRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.collapsible){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(e.options.closed){return}if(c.onBeforeCollapse&&e._trigger("onBeforeCollapse")===false){return false}b.hide();c.onCollapse&&e._trigger("onCollapse");this._getRegionProxy(d).show();this._resizeRegion()}},expandRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.collapsible){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(e.options.closed){return}if(c.onBeforeExpand&&e._trigger("onBeforeExpand")===false){return false}b.show();c.onExpand&&e._trigger("onExpand");this._getRegionProxy(d).hide();this._resizeRegion()}},closeRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.closable){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(e.options.closed){return}b.find(">.om-panel-body").omPanel("close");this._getRegionProxy(d).hide();this._resizeRegion()}},openRegion:function(d){var c=this._getPanelOpts(d);if(!c||!c.closable){return}var b=this._getRegion(d);$body=b.find(">.om-panel-body");if(b){var e=a.data($body[0],"omPanel");if(!e.options.closed){return}b.find(">.om-panel-body").omPanel("open");this._getRegionProxy(d).hide();this._resizeRegion()}}})})(jQuery);