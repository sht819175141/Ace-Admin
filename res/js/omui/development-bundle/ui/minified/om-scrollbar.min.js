(function(a){a.omWidget("om.omScrollbar",{options:{thick:8},_create:function(){var b=this.options;this._vScrollbar=a("<div class='om-widget om-scrollbar om-corner-all'></div>").width(b.thick).appendTo("body").hide();this._vScrollbar.type="v";this._hScrollbar=a("<div class='om-widget om-scrollbar om-corner-all'></div>").height(b.thick).appendTo("body").hide();this._hScrollbar.type="h"},_init:function(){this.element.css("overflow","hidden");this._buildEvent()},destroy:function(){this._vScrollbar.remove();this._hScrollbar.remove()},_buildEvent:function(){var e=this,d=this.element,c=[this._vScrollbar,this._hScrollbar];a(c).each(function(g,i){i._hover=false;i._enable=true;var h=i.type;var f=0;i.omDraggable({axis:h==="v"?"y":"x",containment:d,onStart:function(k,j){f=h==="v"?d.scrollTop():d.scrollLeft()},onDrag:function(k,j){var l=k.position,m=k.originalPosition;h=="v"?d.scrollTop(f+e._getInt((l.top-m.top)*d.innerHeight()/i.outerHeight())):d.scrollLeft(f+e._getInt((l.left-m.left)*d.innerWidth()/i.outerWidth()))}}).hover(function(){a(c).each(function(j,k){k._hover=true;clearTimeout(k._timer)});a(this).addClass("scrollbar-state-hover")},function(){a(c).each(function(j,k){k._hover=false;e._setTimer(k.type)});a(this).removeClass("scrollbar-state-hover")})});var b=a.browser.mozilla?"DOMMouseScroll":"mousewheel";d.bind(b,function(f){e._mousewheelListener.call(e,f)});a(c).each(function(f,g){g.bind(b,function(h){e._mousewheelListener.call(e,h)})});d.hover(function(){a(c).each(function(f,g){g._hover=true;clearTimeout(g._timer);e._resize(g);if(g._enable){g.fadeIn("fast")}})},function(){a(c).each(function(f,g){g._hover=false;e._setTimer(g.type)})})},_mousewheelListener:function(d){var k=this;if(!k._vScrollbar._enable){return}var j=0;if(d.wheelDelta){j=-d.wheelDelta}else{j=d.detail*40}var b=j/120*10,f=k._vScrollbar,e=k.element,h=e.offset().top+k._getInt(e.css("border-top-width"))+k._getInt(e.css("padding-top"))+k._getInt(e.css("padding-top-width")),g=f.position().top-h,i=e.height(),c=i-f.outerHeight();if(b+g<0){f.css("top",h);e.scrollTop(0)}else{if(b+g>c){f.css("top",h+c);e.scrollTop(e[0].scrollHeight-e.height())}else{f.css("top","+="+b);e.scrollTop(e.scrollTop()+parseInt(b*e.innerHeight()/f.outerHeight()))}}d.preventDefault()},_getScrollbar:function(b){return"h"===b?this._hScrollbar:this._vScrollbar},_setTimer:function(c){var b=this;clearTimeout(this._getScrollbar(c)._timer);(function(d){setTimeout(function(){var e=b._getScrollbar(d);if(!e._hover){e.fadeOut("fast")}},200)})(c)},refresh:function(){var c=[this._vScrollbar,this._hScrollbar],b=this;a(c).each(function(d,e){b._resize(e)})},_resize:function(d){var b=this.element,k=d.type,q=0,g=b.offset(),l=b.width(),i=b.height(),e=b.outerWidth(),n=b.outerHeight(),c=this._getInt(b.css("border-left-width")),o=this._getInt(b.css("border-right-width")),m=this._getInt(b.css("border-top-width")),j=this._getInt(b.css("border-bottom-width")),f=this._getInt(b.css("padding-left")),p=this._getInt(b.css("padding-top"));if("v"===k){q=b[0].scrollHeight;if(q>i){d._enable=true;d.outerHeight(this._getInt(i*b.innerHeight()/q));d.css({left:g.left+e-d.outerWidth()-o,top:g.top+m+p+this._getInt(b.scrollTop()*i/q)})}else{d._enable=false}}else{if("h"===k){q=b[0].scrollWidth;if(q>b.innerWidth()){d._enable=true;d.outerWidth(this._getInt((f+l)*l/q));d.css({left:g.left+c+f+this._getInt(b.scrollLeft()*l/q),top:g.top+n-d.outerHeight()-j})}else{d._enable=false}}}d._enable?d.fadeIn("fast"):d.fadeOut("fast")},_getInt:function(b){return parseInt(b)||0}})})(jQuery);